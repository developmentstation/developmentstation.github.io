<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Performance Analyzer - DevTools Hub</title>
  <meta name="description" content="Measure page performance using the Performance API: timings, resources, paints.">
  <link rel="stylesheet" href="../assets/css/modern-styles.css">
  <meta name="color-scheme" content="light dark">
</head>
<body data-theme="light">
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <button class="btn btn-ghost" onclick="goBack()" aria-label="Go back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          </button>
          <a href="../index.html" class="logo"><span class="logo-icon">üõ†Ô∏è</span><span>DevTools Hub</span></a>
        </div>
        <nav class="nav-links">
          <a href="../index.html" class="nav-link">Home</a>
          <a href="#" class="nav-link active">Performance</a>
        </nav>
        <div class="header-actions">
          <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search tools..." class="search-input">
            <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
          </div>
          <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme"><span id="themeIcon">üåô</span></button>
        </div>
      </div>
    </div>
  </header>

  <main class="main">
    <div class="container">
      <div class="tool-layout">
        <div class="tool-content">
          <div class="tool-header">
            <div class="tool-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/></svg></div>
            <div class="tool-info"><h1>Performance Analyzer</h1><p class="tool-description">Analyze this page's performance with built-in browser metrics.</p></div>
          </div>

          <div class="card mb-6">
            <div class="card-header"><div class="card-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg></div><div><h3 class="card-title">Actions</h3></div></div>
            <div class="btn-group" style="padding:1rem"><button class="btn btn-primary" onclick="run()">Run Analysis</button><button class="btn" onclick="copyOut()">Copy</button><button class="btn btn-ghost" onclick="clearOut()">Clear</button></div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 11 12 14 22 4"/></svg></div><div><h3 class="card-title">Report</h3></div></div>
            <div class="form-group" style="padding:1rem"><textarea id="out" class="form-textarea" rows="20" placeholder="Report will appear here..."></textarea></div>
          </div>
        </div>
        <div class="tool-sidebar">
          <div class="card"><div class="card-header"><div class="card-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg></div><div><h3 class="card-title">Notes</h3></div></div>
            <div class="text-sm text-secondary" style="padding:1rem;">Metrics are specific to this tool page. For other pages, open the tool in a new tab and navigate, or paste HTML into a local test page.</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section"><h4>DevTools Hub</h4><p>Professional developer tools that work offline.</p></div>
        <div class="footer-section"><h4>Performance</h4><a href="performance-analyzer.html">Analyzer</a></div>
        <div class="footer-section"><h4>Popular</h4><a href="../tools/json-formatter.html">JSON</a><a href="../tools/qr-generator.html">QR</a></div>
        <div class="footer-section"><h4>Features</h4><span>‚úì Offline</span></div>
      </div>
      <div class="footer-bottom"><p>&copy; 2024 DevTools Hub.</p></div>
    </div>
  </footer>

  <script src="../assets/js/modern-shared.js"></script>
  <script>
    function clearOut(){ document.getElementById('out').value=''; }
    function copyOut(){ const t=document.getElementById('out').value; if(!t){ (window.ToastManager?ToastManager:alert)('Nothing to copy'); return;} if(window.ClipboardManager) window.ClipboardManager.copyText(t); else if(navigator.clipboard) navigator.clipboard.writeText(t); (window.ToastManager?ToastManager:alert)('Copied'); }
    function fmt(ms){ return Math.round(ms) + ' ms'; }
    async function run(){
      const lines=[];
      if(performance.getEntriesByType){
        const nav = performance.getEntriesByType('navigation')[0];
        if(nav){
          lines.push('[Navigation Timing]');
          lines.push('DNS: ' + fmt(nav.domainLookupEnd - nav.domainLookupStart));
          lines.push('TCP: ' + fmt(nav.connectEnd - nav.connectStart));
          lines.push('TLS: ' + (nav.secureConnectionStart>0? fmt(nav.connectEnd - nav.secureConnectionStart) : '‚Äî'));
          lines.push('TTFB: ' + fmt(nav.responseStart - nav.requestStart));
          lines.push('Response: ' + fmt(nav.responseEnd - nav.responseStart));
          lines.push('DOM Content Loaded: ' + fmt(nav.domContentLoadedEventEnd - nav.startTime));
          lines.push('Load Event: ' + fmt(nav.loadEventEnd - nav.startTime));
          lines.push('');
        }
        const res = performance.getEntriesByType('resource');
        let total=0; let largest=0; let largestName='';
        for(const r of res){ total += (r.transferSize||0); if((r.transferSize||0) > largest){ largest = r.transferSize||0; largestName = r.name; } }
        lines.push('[Resources]');
        lines.push('Count: ' + res.length);
        lines.push('Total transfer: ' + (total? (Math.round(total/1024)+' KB') : 'n/a'));
        lines.push('Largest: ' + (largest? (largestName + ' ('+Math.round(largest/1024)+' KB)') : 'n/a'));
        lines.push('');
      }
      if('PerformanceObserver' in window){
        try{
          const fcp = await new Promise((resolve)=>{
            const po = new PerformanceObserver((list)=>{
              const e = list.getEntries().find(e=>e.name==='first-contentful-paint');
              if(e){ resolve(e.startTime); po.disconnect(); }
            });
            po.observe({ type:'paint', buffered:true });
            setTimeout(()=>{ try{po.disconnect();}catch{} resolve(null); }, 100);
          });
          lines.push('[Paint]');
          lines.push('First Contentful Paint: ' + (fcp? fmt(fcp) : 'n/a'));
          lines.push('');
        }catch{}
      }
      lines.push('[Suggestions]');
      lines.push('- Use rel=preload for critical CSS/JS');
      lines.push('- Defer non-critical scripts (defer/async)');
      lines.push('- Lazy-load images and large media');
      lines.push('- Compress and cache static assets');
      document.getElementById('out').value = lines.join('\n');
    }
  </script>
</body>
</html>


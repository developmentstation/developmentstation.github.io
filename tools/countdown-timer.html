<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Countdown Timer - DevTools Hub</title>
  <meta name="description" content="Create a countdown to a target date and time. Pause, resume, and reset. Offline, privacy‚Äëfriendly.">
  <meta name="keywords" content="countdown, timer, date timer, deadline, stopwatch">
  <meta name="author" content="DevTools Hub">
  <meta name="robots" content="index, follow">

  <meta name="theme-color" content="#3b82f6">
  <meta name="color-scheme" content="light dark">

  <link rel="stylesheet" href="../assets/css/modern-styles.css">
</head>
<body data-theme="light">
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <button class="btn btn-ghost" onclick="goBack()" aria-label="Go back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <a href="../index.html" class="logo">
            <span class="logo-icon">üõ†Ô∏è</span>
            <span>DevTools Hub</span>
          </a>
        </div>
        <nav class="nav-links">
          <a href="../index.html" class="nav-link">Home</a>
          <a href="#" class="nav-link active" onclick="filterTools('time')">Time & Date</a>
          <a href="world-clock.html" class="nav-link">World Clock</a>
          <a href="date-calculator.html" class="nav-link">Date Calc</a>
        </nav>
        <div class="header-actions">
          <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search tools..." class="search-input">
            <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
          </div>
          <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme"><span id="themeIcon">üåô</span></button>
        </div>
      </div>
    </div>
  </header>

  <div class="breadcrumb">
    <div class="container">
      <nav class="breadcrumb-nav" aria-label="Breadcrumb"></nav>
    </div>
  </div>

  <main class="main">
    <div class="container">
      <div class="tool-layout">
        <div class="tool-content">
          <div class="tool-header">
            <div class="tool-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="13" r="8"/>
                <path d="M12 9v4l3 2"/>
                <path d="M9 2h6M7 3l2 2M17 3l-2 2"/>
              </svg>
            </div>
            <div class="tool-info">
              <h1>Countdown Timer</h1>
              <p class="tool-description">Count down to any target date and time with live updates.</p>
            </div>
          </div>

          <div class="card mb-6">
            <div class="card-header">
              <div class="card-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/></svg>
              </div>
              <div>
                <h3 class="card-title">Target</h3>
                <p class="card-description">Set your countdown goal</p>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="cdTitle">Title (optional)</label>
                <input id="cdTitle" type="text" class="form-input" placeholder="e.g., Project launch">
              </div>
              <div class="form-group">
                <label class="form-label" for="cdDate">Date</label>
                <input id="cdDate" type="date" class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label" for="cdTime">Time</label>
                <input id="cdTime" type="time" class="form-input" value="00:00">
              </div>
            </div>
            <div class="btn-group">
              <button class="btn btn-primary" onclick="startCountdown()">Start</button>
              <button class="btn btn-secondary" onclick="pauseCountdown()" id="pauseBtn" disabled>Pause</button>
              <button class="btn btn-outline" onclick="resetCountdown()" id="resetBtn" disabled>Reset</button>
            </div>
            <div class="btn-group" style="margin-top:0">
              <button class="btn btn-ghost btn-sm" onclick="preset(5)">+5 min</button>
              <button class="btn btn-ghost btn-sm" onclick="preset(15)">+15 min</button>
              <button class="btn btn-ghost btn-sm" onclick="preset(60)">+1 hr</button>
              <button class="btn btn-ghost btn-sm" onclick="preset(1440)">+1 day</button>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="6" height="6" rx="1"/><rect x="15" y="3" width="6" height="6" rx="1"/></svg>
              </div>
              <div>
                <h3 class="card-title">Countdown</h3>
                <p class="card-description" id="cdLabel">Waiting to start‚Ä¶</p>
              </div>
            </div>
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;text-align:center;">
              <div class="card" style="padding:1rem;"><div class="font-mono" style="font-size:2rem;" id="d">0</div><div class="text-secondary">Days</div></div>
              <div class="card" style="padding:1rem;"><div class="font-mono" style="font-size:2rem;" id="h">0</div><div class="text-secondary">Hours</div></div>
              <div class="card" style="padding:1rem;"><div class="font-mono" style="font-size:2rem;" id="m">0</div><div class="text-secondary">Minutes</div></div>
              <div class="card" style="padding:1rem;"><div class="font-mono" style="font-size:2rem;" id="s">0</div><div class="text-secondary">Seconds</div></div>
            </div>
          </div>
        </div>

        <div class="tool-sidebar">
          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
              </div>
              <div><h3 class="card-title">Tips</h3></div>
            </div>
            <ul class="text-xs text-secondary" style="list-style:disc;padding-left:18px;">
              <li>Title is shown above the countdown.</li>
              <li>Use presets for quick targets.</li>
              <li>Timer runs locally and works offline.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>DevTools Hub</h4>
          <p>Professional developer tools that work offline. Privacy‚Äëfocused and completely free.</p>
        </div>
        <div class="footer-section">
          <h4>Time & Date</h4>
          <a href="countdown-timer.html">Countdown</a>
          <a href="world-clock.html">World Clock</a>
          <a href="unix-timestamp-converter.html">Unix Timestamp</a>
        </div>
        <div class="footer-section">
          <h4>Popular</h4>
          <a href="../tools/json-formatter.html">JSON Formatter</a>
          <a href="../tools/qr-generator.html">QR Generator</a>
          <a href="../tools/password-generator.html">Password Generator</a>
        </div>
        <div class="footer-section">
          <h4>Features</h4>
          <span>‚úì Works Offline</span>
          <span>‚úì No Data Collection</span>
          <span>‚úì Mobile Friendly</span>
        </div>
      </div>
      <div class="footer-bottom"><p>&copy; 2024 DevTools Hub. Built with ‚ù§Ô∏è for developers.</p></div>
    </div>
  </footer>

  <script src="../assets/js/modern-shared.js"></script>
  <script>
    let timer = null; let targetMs = 0; let paused = false; let remainingMs = 0;
    const CD_STORAGE_KEY = 'devtools_hub_countdown_state_v1';

    function preset(minutes){
      const now = new Date();
      now.setMinutes(now.getMinutes() + minutes);
      document.getElementById('cdDate').value = toDateInput(now);
      document.getElementById('cdTime').value = toTimeInput(now);
      startCountdown();
    }

    function startCountdown(){
      const dateStr = document.getElementById('cdDate').value;
      const timeStr = document.getElementById('cdTime').value || '00:00';
      if (!dateStr){ if (window.ToastManager) window.ToastManager.info('Select a date'); return; }
      const t = new Date(`${dateStr}T${timeStr}:00`);
      targetMs = t.getTime();
      if (isNaN(targetMs)){ if (window.ToastManager) window.ToastManager.error('Invalid date/time'); return; }
      paused = false; remainingMs = 0;
      document.getElementById('pauseBtn').disabled = false;
      document.getElementById('resetBtn').disabled = false;
      const title = document.getElementById('cdTitle').value.trim();
      document.getElementById('cdLabel').textContent = title ? title : 'Active countdown';
      saveState();
      tick();
      if (timer) clearInterval(timer);
      timer = setInterval(tick, 1000);
    }

    function pauseCountdown(){
      if (!timer && !remainingMs) return;
      if (!paused){
        paused = true;
        if (timer) clearInterval(timer);
        remainingMs = Math.max(0, targetMs - Date.now());
        document.getElementById('pauseBtn').textContent = 'Resume';
        saveState();
      } else {
        paused = false;
        targetMs = Date.now() + remainingMs;
        document.getElementById('pauseBtn').textContent = 'Pause';
        timer = setInterval(tick, 1000);
        tick();
        saveState();
      }
    }

    function resetCountdown(){
      if (timer) clearInterval(timer);
      timer = null; targetMs = 0; paused = false; remainingMs = 0;
      setDisplay(0,0,0,0);
      document.getElementById('pauseBtn').disabled = true; document.getElementById('pauseBtn').textContent='Pause';
      document.getElementById('resetBtn').disabled = true;
      document.getElementById('cdLabel').textContent = 'Waiting to start‚Ä¶';
      clearState();
    }

    function tick(){
      if (paused) return;
      const diff = Math.max(0, targetMs - Date.now());
      const totalSec = Math.floor(diff / 1000);
      const d = Math.floor(totalSec / 86400);
      const h = Math.floor((totalSec % 86400) / 3600);
      const m = Math.floor((totalSec % 3600) / 60);
      const s = totalSec % 60;
      setDisplay(d,h,m,s);
      if (diff <= 0){
        resetCountdown();
        if (window.ToastManager) window.ToastManager.success('Time\'s up!');
        beep();
      }
    }

    function setDisplay(d,h,m,s){
      document.getElementById('d').textContent = d;
      document.getElementById('h').textContent = h.toString().padStart(2,'0');
      document.getElementById('m').textContent = m.toString().padStart(2,'0');
      document.getElementById('s').textContent = s.toString().padStart(2,'0');
    }

    function toDateInput(d){
      const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }
    function toTimeInput(d){
      const hh=String(d.getHours()).padStart(2,'0'); const mm=String(d.getMinutes()).padStart(2,'0');
      return `${hh}:${mm}`;
    }

    document.addEventListener('DOMContentLoaded', () => {
      const now = new Date();
      document.getElementById('cdDate').value = toDateInput(now);
      document.getElementById('cdTime').value = toTimeInput(now);
      // Restore persisted countdown if available
      const st = loadState();
      if (st){
        document.getElementById('cdTitle').value = st.title || '';
        if (st.targetMs) {
          const t = new Date(st.targetMs);
          document.getElementById('cdDate').value = toDateInput(t);
          document.getElementById('cdTime').value = toTimeInput(t);
        }
        paused = !!st.paused;
        targetMs = st.targetMs || 0;
        remainingMs = st.remainingMs || 0;
        if (st.paused && st.remainingMs){
          // Display remaining and enable controls
          document.getElementById('pauseBtn').disabled = false;
          document.getElementById('resetBtn').disabled = false;
          document.getElementById('pauseBtn').textContent = 'Resume';
          const sec = Math.floor(st.remainingMs/1000);
          const d = Math.floor(sec/86400);
          const h = Math.floor((sec%86400)/3600);
          const m = Math.floor((sec%3600)/60);
          const s = sec%60;
          setDisplay(d,h,m,s);
          document.getElementById('cdLabel').textContent = st.title || 'Paused countdown';
        } else if (!st.paused && st.targetMs && st.targetMs > Date.now()){
          // Resume running countdown
          document.getElementById('pauseBtn').disabled = false;
          document.getElementById('resetBtn').disabled = false;
          document.getElementById('cdLabel').textContent = st.title || 'Active countdown';
          if (timer) clearInterval(timer);
          timer = setInterval(tick, 1000);
          tick();
        } else {
          clearState();
        }
      }
    });

    // Persistence helpers
    function saveState(){
      try {
        const state = {
          title: document.getElementById('cdTitle').value.trim() || '',
          targetMs,
          paused,
          remainingMs
        };
        localStorage.setItem(CD_STORAGE_KEY, JSON.stringify(state));
      } catch {}
    }

    function loadState(){
      try { const raw = localStorage.getItem(CD_STORAGE_KEY); return raw ? JSON.parse(raw) : null; } catch { return null; }
    }

    function clearState(){
      try { localStorage.removeItem(CD_STORAGE_KEY); } catch {}
    }

    // Simple beep using Web Audio API
    function beep(){
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = 'sine';
        o.frequency.setValueAtTime(880, ctx.currentTime);
        g.gain.setValueAtTime(0.0001, ctx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.4);
        o.connect(g); g.connect(ctx.destination);
        o.start(); o.stop(ctx.currentTime + 0.45);
      } catch {}
    }
  </script>
</body>
</html>

